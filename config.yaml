# Prompt Learning Loop Configuration
# Copy this file and customize for your environment

# Teacher LLM configuration
teacher:
  # Mode: "local" uses Anthropic SDK directly, "webhook" uses n8n Cloud
  mode: "local"
  # Model to use for local mode (ignored if mode is webhook)
  model: "claude-3-5-haiku-20241022"
  # Max tokens for responses
  max_tokens: 1024

# n8n webhook configuration (only used if teacher.mode is "webhook")
n8n:
  # Webhook URL for the n8n Teacher workflow
  webhook_url: "https://im4tlai.app.n8n.cloud/webhook/prompt-learning-teacher"
  # Timeout for webhook calls (seconds)
  timeout: 60

learning:
  # Maximum retry attempts before giving up
  max_retries: 3
  # Automatically retry after learning a rule (true) or wait for manual trigger (false)
  auto_retry: true

# Failure sources configuration
# Defines what types of failures can be captured and analyzed
failure_sources:
  # Test-based failures (pytest, jest, etc.)
  - name: "pytest"
    type: "automated"
    enabled: true
    description: "Captures test failures from pytest runs"

  # Manual failure reports (planning errors, integration mistakes, etc.)
  - name: "manual"
    type: "user_reported"
    enabled: true
    description: "Captures manually reported failures via 'report-failure' command"

  # Semantic analysis (future: LLM reviews Claude output for quality issues)
  - name: "semantic"
    type: "llm_analysis"
    enabled: false
    description: "LLM-based analysis of Claude Code output quality"

# Failure type to prompt mapping
# Maps failure types to the appropriate system prompt
failure_prompts:
  test_failure: "default"
  planning_error: "planning_error_system"
  integration_error: "integration_error_system"
  workflow_error: "workflow_error_system"
  architecture_error: "architecture_error_system"
  scope_error: "planning_error_system"
  config_error: "integration_error_system"

tests:
  # Test framework (currently only pytest is supported)
  framework: "pytest"
  # Command to run tests - customize for your project
  command: "pytest tests/ -v --tb=short"
  # Timeout for test execution (seconds)
  timeout: 120

claude:
  # Maximum agentic turns per attempt
  max_turns: 15
  # Output format for Claude CLI
  output_format: "json"
  # Permission mode (use with caution in production)
  # Options: "dangerously-skip-permissions" for full automation
  permission_mode: "dangerously-skip-permissions"

# Logging configuration
logging:
  # Log level: DEBUG, INFO, WARNING, ERROR
  level: "INFO"
  # Save detailed logs to file
  log_file: null  # Set to path like "./learning_loop.log" to enable
